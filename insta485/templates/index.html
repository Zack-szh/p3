
<!DOCTYPE html>
<html lang="en">

<head> 
    <meta charset="utf-8">
    <title> insta485 </title>
</head>

<body>
    <nav>  <a href="/">insta485</a> | 
       
        <a href="/explore/">explore</a> | 
        <!--<a href="/users/{{ logname }}/">{{ logname }}</a>-->
        <a href="users/{{ logname }}/">{{ logname }}</a>
    </nav>
    
    <main> 
        <!-- Post1 -->
        {% for post in posts %}
            <article> 
                <header> 
                    <a href="/users/{{ post.owner }}/">
                        <img src="{{ url_for('uploaded_file', filename=post.pfp_url) }}" alt="profilePic" height="40" width="40">


                        {{ post.owner }}
                    </a>
                    <a href="/posts/{{ post.postid }}/">
                        {{ post.timestamp }}
                    </a>
                </header>

                <div> 
                    <img src="{{ url_for('uploaded_file', filename=post.filename) }}" alt="postPic" height="400" width="400">
                </div>

                <p>{{post.num_likes}} {{ "like" if post.num_likes == 1 else "likes" }}</p>
                {% if post['liked'] %}
                    <form action="/likes/?target={{ request.path }}" method="post">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="operation" value="unlike"/>
                    <input type="hidden" name="postid" value="{{ post['postid'] }}"/>
                    <input type="submit" name="unlike" value="unlike"/>
                    </form>
                {% else %}
                    <form action="/likes/?target={{ request.path }}" method="post">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="operation" value="like"/>
                    <input type="hidden" name="postid" value="{{ post['postid'] }}"/>
                    <input type="submit" name="like" value="like"/>
                    </form>
                {% endif %}

                <ul>
                    {% for comment in post.comments %}
                    <li> 
                        <a href="/users/{{ comment.owner }}/"> 
                            {{ comment.owner }} 
                        </a>
                        {{ comment.text }}
                    </li>
                    {% endfor %}
                </ul>
                <form action="/comments/?target={{ request.path }}" method="post" enctype="multipart/form-data">
                    <input type="hidden" name="csrf_token" value="{{ csrf_token() }}">
                    <input type="hidden" name="operation" value="create"/>
                    <input type="hidden" name="postid" value="{{ post['postid'] }}"/>
                    <input type="text" name="text" required/>
                    <input type="submit" name="comment" value="comment"/>
                </form>
            </article>
        {% endfor %}

    </main>

</body>



</html>

